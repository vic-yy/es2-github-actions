# .github/workflows/main.yml

# Nome do seu workflow (aparecerá na aba "Actions")
name: Build e Teste Multi-OS

# Define quando o workflow deve rodar
# Neste caso, a cada 'push' ou 'pull request' para a branch 'main'
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# Define os "trabalhos" (jobs) que serão executados
jobs:
  build-and-test:
    # Define o nome do job
    name: Testar em ${{ matrix.os }} com Python ${{ matrix.python-version }}

    # A "strategy" (estratégia) define a matriz de execução
    strategy:
      # A matriz (matrix) combina OS e versões de linguagem
      matrix:
        # REQUISITO: Três sistemas operacionais
        os: [ubuntu-latest, windows-latest, macos-latest]

        # REQUISITO: Pelo menos duas versões da linguagem
        python-version: ['3.8', '3.11'] # Você pode usar as versões que quiser

    # Define que o job rodará no OS especificado pela matriz
    runs-on: ${{ matrix.os }}

    # "steps" (passos) são as tarefas que o job executará
    steps:
    # 1. Pega o código do repositório
    - name: 1. Checkout do código
      uses: actions/checkout@v4

    # 2. Configura a versão do Python (vinda da matriz)
    - name: 2. Configurar Python ${{ matrix.python-version }}
      uses: actions/setup-python@v5
      with:
        python-version: ${{ matrix.python-version }}

    # 3. Instala as dependências (pytest)
    - name: 3. Instalar dependências
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # 4. Roda os testes
    - name: 4. Executar testes com pytest
      run: pytest